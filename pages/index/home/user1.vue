<!--
此文件为开发者工具生成，生成时间: 2023/7/6下午4:17:42
使用方法：
在 D:\work\mall-applet\unpackage\dist\dev\mp-weixin\pages\index\home\userHome.wxml 引入模板

```
<import src="userHome.skeleton.wxml"/>
<template is="skeleton" wx:if="{{loading}}" />
```

在 D:\work\mall-applet\unpackage\dist\dev\mp-weixin\pages\index\home\userHome.wxss 中引入样式
```
@import "./userHome.skeleton.wxss";
```

更多详细信息可以参考文档：https://developers.weixin.qq.com/miniprogram/dev/devtools/skeleton.html
-->
<template name="skeleton">
  <view class="sk-container">
    <view class="data-v-122e0e94">
      <view class="container data-v-122e0e94">
        <view class="container-top data-v-122e0e94">
          <view class="header-top data-v-122e0e94">
            <text class="data-v-122e0e94 sk-transparent sk-text-14-5833-916 sk-text" style="background-position-x: 50%;">私人银行服务平台</text>
          </view>
          <view   class="data-v-122e0e94">
            <view class="data-v-46ced562 commSearch--data-v-46ced562">
              <view class="search-and-address commSearch--search-and-address data-v-46ced562 commSearch--data-v-46ced562">
                <view class="bg-sear commSearch--bg-sear data-v-46ced562 commSearch--data-v-46ced562">
                  <view class="scrolltop commSearch--scrolltop data-v-46ced562 commSearch--data-v-46ced562" data-event-opts="tap,toSearchPage,$event">
                    <view class="section commSearch--section data-v-46ced562 commSearch--data-v-46ced562">
                      <text class="iconfont commSearch--iconfont icon-sousuo commSearch--icon-sousuo data-v-46ced562 commSearch--data-v-46ced562 sk-pseudo sk-pseudo-circle"></text>
                      <text class="placeholder commSearch--placeholder data-v-46ced562 commSearch--data-v-46ced562 sk-transparent sk-text-15-7895-410 sk-text">输入关键字搜索</text>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
          <view class="content data-v-122e0e94">
            <view class="swiper data-v-122e0e94">
              <view class="u-swiper swiper--u-swiper data-v-7b038a67 swiper--data-v-7b038a67" style="background-color:#f3f4f6;height:96px;border-radius:1px;">
                <swiper autoplay="false" class="u-swiper__wrapper swiper--u-swiper__wrapper data-v-7b038a67 swiper--data-v-7b038a67" current="0" data-event-opts="change,change,$event" display-multiple-items="1" duration="300" easing-function="default" interval="3000"
                  next-margin="0rpx" previous-margin="0rpx" style="height:96px;" circular="true">
                  <swiper-item class="u-swiper__wrapper__item swiper--u-swiper__wrapper__item data-v-7b038a67 swiper--data-v-7b038a67" style="position: absolute; width: 100%; height: 100%; transform: translate(0%, 0px) translateZ(0px);">
                    <view class="u-swiper__wrapper__item__wrapper swiper--u-swiper__wrapper__item__wrapper data-v-7b038a67 swiper--data-v-7b038a67" style="true">
                      <image class="u-swiper__wrapper__item__wrapper__image swiper--u-swiper__wrapper__item__wrapper__image data-v-7b038a67 swiper--data-v-7b038a67 sk-image" data-event-opts="tap,clickHandler,0" mode="aspectFill" style="height:96px;border-radius:1px;"></image>
                    </view>
                  </swiper-item>
                  <swiper-item class="u-swiper__wrapper__item swiper--u-swiper__wrapper__item data-v-7b038a67 swiper--data-v-7b038a67" style="position: absolute; width: 100%; height: 100%; transform: translate(100%, 0px) translateZ(0px);">
                    <view class="u-swiper__wrapper__item__wrapper swiper--u-swiper__wrapper__item__wrapper data-v-7b038a67 swiper--data-v-7b038a67" style="true">
                      <image class="u-swiper__wrapper__item__wrapper__image swiper--u-swiper__wrapper__item__wrapper__image data-v-7b038a67 swiper--data-v-7b038a67 sk-image" data-event-opts="tap,clickHandler,1" mode="aspectFill" style="height:96px;border-radius:1px;"></image>
                    </view>
                  </swiper-item>
                </swiper>
                <view class="u-swiper__indicator swiper--u-swiper__indicator data-v-7b038a67 swiper--data-v-7b038a67" style="true">
                  <view class="u-swiper-indicator indicator--u-swiper-indicator data-v-647f6c67 indicator--data-v-647f6c67">
                    <view class="u-swiper-indicator__wrapper indicator--u-swiper-indicator__wrapper data-v-647f6c67 indicator--data-v-647f6c67 u-swiper-indicator__wrapper--line indicator--u-swiper-indicator__wrapper--line" style="width:31px;background-color:rgba(255, 255, 255, 0.35);">
                      <view class="u-swiper-indicator__wrapper--line__bar indicator--u-swiper-indicator__wrapper--line__bar data-v-647f6c67 indicator--data-v-647f6c67" style="width:10px;transform:translateX(0px);background-color:#FFFFFF"></view>
                    </view>
                  </view>
                </view>
              </view>
            </view>
            <view   class="data-v-122e0e94" data-event-opts="^CateEvent,toCouponCenter">
              <view class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                <view class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 cat-row-1 cateGroup--cat-row-1">
                  <view class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                    <view class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                      <swiper class="swiper cateGroup--swiper data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" indicator-dots="true" current="0" autoplay="false">
                        <swiper-item class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" style="position: absolute; width: 100%; height: 100%; transform: translate(0%, 0px) translateZ(0px);">
                          <view class="cat-item cateGroup--cat-item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-197 sk-text" style="background-position-x: 50%;">餐饮美食</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-203 sk-text" style="background-position-x: 50%;">休闲玩乐</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-276 sk-text" style="background-position-x: 50%;">生活服务</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-117 sk-text" style="background-position-x: 50%;">健康守护</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-690 sk-text" style="background-position-x: 50%;">美容养颜</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-912 sk-text" style="background-position-x: 50%;">品质出行</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-212 sk-text" style="background-position-x: 50%;">出国留学</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-825 sk-text" style="background-position-x: 50%;">艺术品鉴</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-877 sk-text" style="background-position-x: 50%;">户外运动</text>
                            </view>
                            <view class="item cateGroup--item data-v-fa8f9c76 cateGroup--data-v-fa8f9c76" data-event-opts="tap,e1,$event" data-event-params="[object Object]" data-sts="item.id">
                              <view class="icon-box cateGroup--icon-box data-v-fa8f9c76 cateGroup--data-v-fa8f9c76">
                                <image class="icon-cover cateGroup--icon-cover data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                              <text class="data-v-fa8f9c76 cateGroup--data-v-fa8f9c76 sk-transparent sk-text-22-2222-33 sk-text" style="background-position-x: 50%;">公益慈善</text>
                            </view>
                          </view>
                        </swiper-item>
                      </swiper>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
        <view class="container-center data-v-122e0e94">
          <view   class="data-v-122e0e94" data-event-opts="^changeIndex,changeIndex">
            <view class="wrap tabs--wrap data-v-4b5d8239 tabs--data-v-4b5d8239">
              <view class="homeBox tabs--homeBox data-v-4b5d8239 tabs--data-v-4b5d8239">
                <scroll-view class="data-v-4b5d8239 tabs--data-v-4b5d8239" enable-flex="true" scroll-left="0" scroll-with-animation="true" scroll-x="true">
                  <view class="tabBox tabs--tabBox data-v-4b5d8239 tabs--data-v-4b5d8239">
                    <view class="tab-item tabs--tab-item data-v-4b5d8239 tabs--data-v-4b5d8239" data-event-opts="tap,changeIndex,0">
                      <view class="data-v-4b5d8239 tabs--data-v-4b5d8239 tab-choice tabs--tab-choice sk-transparent sk-text-15-2174-578 sk-text sk-pseudo sk-pseudo-circle" style="background-position-x: 50%;">关注/推荐</view>
                    </view>
                    <view class="tab-item tabs--tab-item data-v-4b5d8239 tabs--data-v-4b5d8239" data-event-opts="tap,changeIndex,1">
                      <view class="data-v-4b5d8239 tabs--data-v-4b5d8239 sk-transparent sk-text-15-0000-960 sk-text" style="background-position-x: 50%;">论坛</view>
                    </view>
                    <view class="tab-item tabs--tab-item data-v-4b5d8239 tabs--data-v-4b5d8239" data-event-opts="tap,changeIndex,2">
                      <view class="data-v-4b5d8239 tabs--data-v-4b5d8239 sk-transparent sk-text-15-0000-856 sk-text" style="background-position-x: 50%;">客户建议</view>
                    </view>
                    <view class="tab-item tabs--tab-item data-v-4b5d8239 tabs--data-v-4b5d8239" data-event-opts="tap,changeIndex,3">
                      <view class="data-v-4b5d8239 tabs--data-v-4b5d8239 sk-transparent sk-text-15-0000-162 sk-text" style="background-position-x: 50%;">项目发布</view>
                    </view>
                  </view>
                </scroll-view>
              </view>
            </view>
          </view>
          <view class="home-content data-v-122e0e94">
            <view class="updata data-v-122e0e94">
              <view class="data-v-122e0e94">
                <view   class="data-v-122e0e94" data-event-opts="^eventParent,toProdPage">
                  <view class="data-v-71f17d11 list--data-v-71f17d11">
                    <view class="hot-sale list--hot-sale data-v-71f17d11 list--data-v-71f17d11">
                      <view class="hotsale-item-cont list--hotsale-item-cont data-v-71f17d11 list--data-v-71f17d11">
                        <scroll-view class="data-v-71f17d11 list--data-v-71f17d11" enable-back-to-top="true">
                          <view class="prod-items list--prod-items data-v-71f17d11 list--data-v-71f17d11" data-event-opts="tap,toProdPage,$0,prods,,0" data-prodid="undefined">
                            <view class="hot-imagecont list--hot-imagecont data-v-71f17d11 list--data-v-71f17d11">
                              <image class="hotsaleimg list--hotsaleimg data-v-71f17d11 list--data-v-71f17d11 sk-image" lazy-load="true" lazy-load-margin="0" mode="aspectFill"></image>
                              <view class="cover-box list--cover-box data-v-71f17d11 list--data-v-71f17d11">
                                <image class="cover list--cover data-v-71f17d11 list--data-v-71f17d11 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                            </view>
                          </view>
                          <view class="prod-items list--prod-items data-v-71f17d11 list--data-v-71f17d11" data-event-opts="tap,toProdPage,$0,prods,,1" data-prodid="undefined">
                            <view class="hot-imagecont list--hot-imagecont data-v-71f17d11 list--data-v-71f17d11">
                              <image class="hotsaleimg list--hotsaleimg data-v-71f17d11 list--data-v-71f17d11 sk-image" lazy-load="true" lazy-load-margin="0" mode="aspectFill"></image>
                              <view class="cover-box list--cover-box data-v-71f17d11 list--data-v-71f17d11">
                                <image class="cover list--cover data-v-71f17d11 list--data-v-71f17d11 sk-image" lazy-load="true" lazy-load-margin="0"></image>
                              </view>
                            </view>
                          </view>
                        </scroll-view>
                      </view>
                    </view>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</template>

<script>
import tabs from '@/components/tabs.vue'
import { createNamespacedHelpers } from 'vuex'
const { mapGetters, mapMutations } = createNamespacedHelpers('commodity')
import commSearch from '@/components/commSearch.vue'
import list from './../components/list.vue'
import { mallShopTypeListByParentId, getCommodityPage } from '@/api/shop.js'
import { ForumPage } from '@/api/index'
import cateGroup from '@/components/cateGroup'
import forum from '@/components/forum'
import recommendation from './../components/recommendation'
import forumData from '@/mock/index.js'
import projectList from '@/components/projectList'
import tabBar from '@/components/tab-bar.vue'
import { getTotalPage } from '@/util/util'
import user1 from "./user1.vue"
export default {
  data() {
    return {
      indicatorDots: true,
      indicatorColor: '#d1e5fb',
      indicatorActiveColor: '#1b7dec',
      autoplay: true,
      interval: 2000,
      duration: 1000,
      list3: [
        'https://cdn.uviewui.com/uview/swiper/swiper3.png',
        'https://cdn.uviewui.com/uview/swiper/swiper2.png',
        'https://cdn.uviewui.com/uview/swiper/swiper1.png',
      ],

      seq: 0,
      news: [],
      statusList: [
        {
          title: '关注/推荐',
        },

        {
          title: '论坛',
        },
        {
          title: '客户建议',
        },
        {
          title: '项目发布',
        },
      ],
      selectClassIndex: 0,

      sts: 0,
      scrollTop: '',
      current: 1,
      size: 10,
      total: 0,
      updata: true,
      list: [],
      prods: [],
      currentForum: 1,
      sizeForum: 10,
      totalForum: 0,
      more: 'more',
      moreForum: 'more',
      loading:false
    }
  },

  components: {
    tabs,
    commSearch,
    list,
    cateGroup,
    forum,
    recommendation,
    projectList,
    tabBar,
    user1
  },
  props: {},
  computed: {
    ...mapGetters(['cateAll', 'projectList']),
    fileUrl() {
      return this.$fileUrl
    },
  },
  created() {
   
    uni.showLoading({
      title: '加载中',
    })
    this.getAllCate()
    this.getCommodityRecommend()
    uni.hideLoading()
  },
  onLoad() {},
  onReady() {},
  onShow() {
    // this.loading=true 
    // setTimeout(()=>{
    //   this.loading=false
    // },1000)
  },

  options: {
    styleIsolation: 'shared',
  },
  onPullDownRefresh() {
    this.getAllCate()
    this.resetPage()
    setTimeout(function () {
      uni.stopPullDownRefresh()
    }, 1000)
  },
  onReachBottom: function () {
    switch (this.selectClassIndex) {
      case 0:
        if (this.more == 'more') {
          this.current++
          this.getCommodityRecommend()
        }
        break
      case 1:
        if (this.moreForum == 'more') {
          this.currentForum++
          this.getForumList()
        }
        break
      default:
        if (this.more == 'more') {
          this.current++
          this.getCommodityRecommend()
        }
    }

    if (this.selectClassIndex == 0) {
    }
  },
  methods: {
    ...mapMutations(['setCateAll', 'setCommodityInfo']),
    resetPage() {
      switch (this.selectClassIndex) {
        case 0:
          this.current = 1
          this.getCommodityRecommend()
          break
        case 1:
          this.currentForum = 1
          this.getForumList()
          break
        default:
          this.current = 1
          this.getCommodityRecommend()
      }
    },
    // 论坛列表
    async getForumList() {
      uni.showLoading({
        title: '加载中',
      })
      try {
        let res = await ForumPage({
          current: this.currentForum,
          size: this.sizeForum,
          type: 'comm',
        })

        this.totalForum = res.total
        let totalPage = getTotalPage(this.totalForum, this.sizeForum)

        if (this.currentForum == 1) {
          this.list = res.data
        } else {
          this.list = [...this.list, ...res.data]
        }

        if (totalPage > this.currentForum) {
          this.moreForum = 'more'
        } else {
          this.moreForum = 'noMore'
        }
      } catch (e) {
        console.log(e)
      } finally {
        uni.hideLoading()
      }
    },
    goProjectList() {
      uni.navigateTo({
        url: '/pages/article/projectList',
      })
    },
    changeIndex(e) {
      this.selectClassIndex = e
      this.resetPage()
    },
    async getCommodityRecommend() {
      uni.showLoading({
        title: '加载中',
      })
      try {
        let res = await getCommodityPage({
          current: this.current,
          size: this.size,
        })
        this.total = res.total
        let totalPage = getTotalPage(this.total, this.size)
        if (this.current == 1) {
          this.prods = res.data
        } else {
          this.prods = [...this.prods, ...res.data]
        }
        if (totalPage > this.current) {
          this.more = 'more'
        } else {
          this.more = 'noMore'
        }
      } catch (e) {
        console.log(e)
      } finally {
        uni.hideLoading()
      }
    },
    //获取所有一级分类
    async getAllCate() {
      try {
        let res = await mallShopTypeListByParentId(0)
        this.setCateAll(res.data)
      } catch (err) {
        console.log('异常：', err)
      }
    },
    changeStu(index) {
      this.selectClassIndex = index
    },

    // 页面滚动到指定位置指定元素固定在顶部
    onPageScroll: function (e) {
      //监听页面滚动
      // this.setData({
      //   scrollTop: e.scrollTop
      // });  
    },
    toProdPage(item) {
      this.setCommodityInfo(item)

      uni.navigateTo({
        url: `/pages/mall/commodity/commodityDetail?Id=${item.id}&shopId=${item.shopId}`,
      })
    },

    toCouponCenter(item) {
      uni.navigateTo({
        url: `/pages/mall/store/index?cateId=${item.id}&title=${item.name}`,
      })
    },
  },
}
</script>
<style>
  @import url('./user1.css');
</style>